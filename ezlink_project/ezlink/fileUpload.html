
<!DOCTYPE html>
<html lang="en" style="height: 100%;">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, shrink-to-fit=no, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>1GFS X-SMART Demo</title>

  <link rel="stylesheet" href="b/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/font.css">
  <link rel="stylesheet" href="css/animate.css">
  <link rel="stylesheet" href="css/sidebar.css">
  <link rel="stylesheet" href="css/loading.css">
  <link rel="stylesheet" href="css/login.css">
  <link rel="stylesheet" href="css/blur.css">
  <link rel="stylesheet" href="css/timeline.css">

  <link rel="stylesheet" href="css/semantic_ui/semantic.min.css">

  <style type="text/css">

    body {
      /*
      background: #76b852;
      background: -webkit-linear-gradient(right, #76b852, #8DC26F);
      background: -moz-linear-gradient(right, #76b852, #8DC26F);
      background: -o-linear-gradient(right, #76b852, #8DC26F);
      */
      background: linear-gradient(to bottom, #ACF, #A3CCFF);
      /*
      background-image: url('bg-sample.jpg');
      background-size: cover;
      background-position: top center !important;
      background-repeat: no-repeat !important;
      */

      font-family: "roboto", sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background-color: #f0f0f0;
      background-image: url("http://www.transparenttextures.com/patterns/cubes.png");

      /* overflow: hidden; */
    }

    #wrapper {
        -webkit-filter: blur(0px);
        filter: blur(0px);
    }

    .card {
      position: relative;
      height: 100%;
      /*outline: dashed rgba(0, 0, 0, 0.25);*/
      background: transparent;
      pointer-events: all;
    }

    #page-content-wrapper-1 {
      -webkit-transition: all 0.3s ease;
      transition: all 0.3s ease;
      /*
      left: 187.5px;
      */
    }

    .signage {
      position: absolute;
      outline: dashed rgba(0, 0, 0, 0.25);
      background: rgba(250, 250, 250, 0.8);
      padding: 10px;
      color: black;
      font-size: 12px;
      opacity: 0;

      pointer-events: none;

      -webkit-transition: all 0.3s ease;
      transition: all 0.3s ease;
    }

    .highlight {
      /*font-size: 14px;*/
      opacity: 1;
    }

    .current-app
    {
      color: rgb(255, 0, 0);
    }

    .underlay {
      position: absolute;
      left: 0;
      top: 80px;
      right: 0;
      margin: 0;
      /* padding: 0; */
    }

    #layers-menu {
      position: absolute;
      top: 60px;
      right: 0px;
      width: 200px;

      -webkit-animation-duration: 0.3s;
      animation-duration: 0.3s;
    }

    #apps-menu {
      position: absolute;
      top: 60px;
      right: 0px;
      width: 200px;

      -webkit-animation-duration: 0.3s;
      animation-duration: 0.3s;
    }

    .list-group-item {
      -webkit-transition: all 0.3s;
      transition: all 0.3s;
    }
    .list-group-item:hover {
      background-color: rgb(200,220,250);
    }

    .phantom {
      position: absolute;
      width: 48%;
      height: 100px;
      background: rgba(255, 255, 255, 0.9);
/*
      -ms-transform: scale(0.5, 0.5);
      -webkit-transform: scale(0.5, 0.5);
      transform: scale(0.5, 0.5);
*/

      box-shadow: 1px 1px 6px 2px rgba(3,3,3,0.1);
    }
    .phantom-left {
      /*
      -ms-transform-origin: left bottom;
      -webkit-transform-origin: left bottom;
      transform-origin: left bottom;
      */
      
      left: 10px; bottom: 10px;
    }
    .phantom-right {
      /*
      -ms-transform-origin: right bottom;
      -webkit-transform-origin: right bottom;
      transform-origin: right bottom;
      */

      right: 10px; bottom: 10px;
    }
    .phantom2 {
      /*position: relative;*/
      width: 100%;
      height: 100%;
    }
    .phantom-handle {
      position: relative;
      width: 100%;
      height: 0px;
      /*
      top: -204px;
      bottom: 204px;
      */

      background: rgba(255, 10, 10, 0.75);
      /*box-shadow: 1px 1px 6px 2px rgba(3,3,3,0.5);*/

      -webkit-transition-duration: 0.3s;
      transition-duration: 0.3s;
    }

    .container
    {
      position:absolute;
      left:0px;
      top:0px;
      right:0px;
      bottom:0px;
      width: 100%;
    /* overflow:hidden; */
      /*background: rgba(0,0,0,0.2);*/
      pointer-events: none;
      padding: 0;
      margin: 0;
    }
    
    .ui.selection.dropdown{
      margin-top: 20px;
    }

  </style>

</head>

<body>

  <div class="navbar navbar-default navbar-static-top" style="margin: 0; box-shadow: 0px 4px 6px rgba(0,0,0,0.1);">
    <button class="btn navbar-btn" style="background:transparent; outline: none;" onclick="toggleSidebar()">
    </button>
    <strong style="font:roboto-bold">1GFS X<span style="color:#1e90ff;font-size:120%;">-</span>SMART</strong> | Ezlink Demo
    <div class="pull-right spinner"></div>

    <!--button type="button" class="pull-right btn navbar-btn" style="background:transparent; outline: none; margin: 0;" onclick="logout()">
      <div class="row">
        <span class="glyphicon glyphicon-log-out"></span>
      </div>
      <small>Logout</small>
    </button-->
<button class="ui mini negative basic button right floated compact" style="margin-top:12px;" onclick="logout()">
  Log Out  <i class="sign out icon"></i>
</button>


  </div>
  
    <div id="wrapper" >
    
    <!-- Page Content -->
    <div id="page-content-wrapper-1">
      <div class="container-fluid">
        <div class="row underlay" style="background-color: #f0f0f0; background-image: url('http://www.transparenttextures.com/patterns/cubes.png');">
          <div class="col-lg-12">
            

  
  
  
<div class="principal" >
  <div class="ui grid">
    <div class="four wide column">
      <div class="ui sticky">
        <div class="ui fluid inverted blue vertical labeled icon menu" id="menu">
          <div class="item"><i class="copyright icon"></i><span>1GFS X-SMART</span></div>
      <a class="item" href="https://52.221.236.100/search" target="_blank"><i class="database icon"></i><span>Data Sets</span></a>
      <a class="item" href="#" target="_blank"><i class="cloud upload icon"></i><span>File Upload</span></a>
          <div class="item"><i class="copyright icon"></i><span>Data Visualizations, 2017</span></div>
        </div>
      </div>
    </div>
    <div class="twelve wide column">
      <div id="contentor">
   
   <!--
   <form enctype="multipart/form-data" action="/tmp/ezlink_project/uploads" method="post">

    <input type="file" id="uploadfiles" multiple="" />
    <button type="submit">Submit</button>

    
  </form> -->
  
  <!--form class="ui form" enctype="multipart/form-data" action="dashboard1.html?authen=passed" method="post"-->
  <form class="ui form">
  <div class="field">
    <label>Data Set Name</label>
    <input type="text" name="dsname" id="dsname" placeholder="Data Set Name">
  </div>
  <div class="field">
    <label>Data Set</label>
	<input type="file" id="uploadfiles" multiple="" />

  </div>
  
  <div class="ui button" id="btnSubmit">Upload</div>
</form>

       
      </div>
    </div>
  </div>
</div>
  
  
  





          </div>
        </div>
      </div>
    </div>


<div class="ui hidden clearing divider"></div>


</div>
  
  <!--div class="login-page">
    <div class="form">
      <form class="login-form">
        <input type="text" placeholder="username" id="nameInput" value="apiuser01"/>
        <input type="password" placeholder="password" id="passwordInput" value="password"/>
        <div onclick="processLogin()" id="submitButton">login</div>
        <p class="message">Not registered? <a href="http://10.217.133.188:8085">Create an account</a></p>
      </form>
    </div>
  </div-->


  <div id="timeline" class="container">
  
  
  </div>

  <div class="signage"></div>


  <script src="js/adax-bundle.min.js"></script>
  <script src="js/helpers.js"></script>

  <script src="js/jquery.min.js"></script>
  <script src="b/js/bootstrap.min.js"></script>

  <script src="js/moment.min.js"></script>
  <script src="js/crossfilter.min.js"></script>
  <script src="js/jquery.slimscroll.min.js"></script>

  <script src="js/misc.js"></script>

  <script src="js/gsap/TweenLite.min.js"></script>
  <script src="js/gsap/utils/Draggable.min.js"></script>
  <script src="js/gsap/plugins/CSSPlugin.min.js"></script>

  <script src="js/semantic.min.js"></script>

  <!-- the main code goes here now -->
  <!--script src="js/main.js"></script-->

  <script>
       $(document)
    .ready(function() { 

    })
  ;
                  var info = {
                        host: 'localhost',
                        origin: 'http://localhost:3000',
                        protocol: 'http:',
                        port: '3000',
                        search: '',
                };
                fillInfo(info);

                //info.host = '10.217.133.188';// ****** set this to point to A*DAX

                var config = {
                        base: 'ws://'+info.host+':3000',
                        token: 'demo00',
                };
                var adax = Adax.clientFactory(config);
                var dataAPI = adax.dataAPI;
                var map3d = adax.m3;
                var map2d = adax.m2;
                var chart = adax.chart;
                var dataTool = adax.dataTool;

                dataAPI.getConfig().ip = info.host;
                dataAPI.getConfig().apim = 'http://'+info.host+':8082';// AWS - 8082, default - 8280

  document.addEventListener("DOMContentLoaded", function(){
     // var uploadfiles = document.querySelector('#uploadfiles');
	  var submit = document.querySelector('#btnSubmit');

      submit.addEventListener('click', function () {
          //alert("Script Started");
		  var dsname= document.getElementById("dsname").value;
		  var uploadfiles= document.getElementById("uploadfiles").files;

		  //alert("dsname>>"+dsname);
        doStuff(uploadfiles,dsname)
	.then(function(result){
		console.log(result);
		window.location.href = "http://52.221.236.100:8080/ezlink/dashboard1.html?authen=passed";

		//alert('script finished' + result)
	})
        //alert("Script Finished");
      }, true);//false);

    });


    var thefiles;
    var datasetid;
    function doStuff(files, dsname)
    {
      thefiles = files;
      return createDataset(dsname)
      .then(createResource)
      .catch(function(err){
        console.log(err);
      })
    }
    function createDataset(dsname)
    {
      var params = {
        owner_org: 'f4418076-6f73-4e8b-9241-a781ac25ab2e', // a-star
        title: dsname,
        notes: 'Random Desp',
        creator: 'fac30647-5898-4c67-b962-c310fe101cf7', // test 01
      };
      return dataAPI.createDataset(params)
    }

    function createResource(datasetresult)
    {
      var json = datasetresult;
	console.log('create dataset result', json)
      datasetid = json.result.id;
      if(thefiles.length > 0)
      {
        var file = thefiles[0];
        return createResourceWithCSV(file);
      }
      else
        return 'no file';
    }

    function createResourceWithCSV(file)
    {
      var user = 'fac30647-5898-4c67-b962-c310fe101cf7'; // test 01
      var notes = 'random resource';
      var e = file.name.split('.');
      var ext = e[e.length-1];
      var params = {
        dataset_id: datasetid,
        title: file.name,
        notes: 'auto-generated notes for ' + file.name,
        mime_type: 'application/' + ext,
        url: '...',
        extension: ext,
      };
      var fd = new FormData();
      for(var key in params)
      {
        fd.append(key, params[key]);
      }

      fd.append("file", file, file.name);
      return dataAPI.createResourceWithCSV(fd)
    }
    
    window.onload = function () {
  
  var param1var = getQueryVariable("authen");
  if(param1var=='passed'){

        dataAPI.login('apiuser01', 'password', '')
        .then(function(result){
          console.log(result);
/*
          if(!result.error)
            login();
          else
          {
            loginShake();
          }
*/
        });

  }
};

    function getQueryVariable(variable) {
      var query = window.location.search.substring(1);
      var vars = query.split("&");
      for (var i=0;i<vars.length;i++) {
      var pair = vars[i].split("=");
      if (pair[0] == variable) {
        return pair[1];
      }
      } 
    }

  

  </script>

</body>

</html>
